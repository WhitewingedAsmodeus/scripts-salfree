(function() {
    'use strict';

    // Adjustable settings
    const CONTRAST_ON = "300%";   // contrast when enabled
    const CONTRAST_OFF = "100%";  // contrast when disabled
    const BRIGHTNESS_ON = "110%"; // optional brightness tweak
    const BRIGHTNESS_OFF = "100%";

    // Load saved state
    let saved = localStorage.getItem('contrastsettings');
    let enabled = saved ? JSON.parse(saved) : false;

    // Apply current state
    const applyFilter = (state) => {
        const canvas = jQuery("canvas");
        if (state) {
            canvas.css("filter", `contrast(${CONTRAST_ON}) brightness(${BRIGHTNESS_ON})`);
        } else {
            canvas.css("filter", `contrast(${CONTRAST_OFF}) brightness(${BRIGHTNESS_OFF})`);
        }
    };

    applyFilter(enabled);

    // Toggle function
    const toggleContrast = () => {
        enabled = !enabled;
        applyFilter(enabled);
        localStorage.setItem('contrastsettings', JSON.stringify(enabled));
        console.log(enabled ? "High Contrast ON" : "High Contrast OFF");
    };

    // Keybind: Ctrl + [
    window.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.key === "[") {
            toggleContrast();
        }
    });

})();

